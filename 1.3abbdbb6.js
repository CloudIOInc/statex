(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{172:function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return p}));var n=r(0),o=r.n(n);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function u(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r,n,o={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var c=o.a.createContext({}),l=function(e){var t=o.a.useContext(c),r=t;return e&&(r="function"==typeof e?e(t):s(s({},t),e)),r},d=function(e){var t=l(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},f=o.a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,a=e.originalType,i=e.parentName,c=u(e,["components","mdxType","originalType","parentName"]),d=l(r),f=n,p=d["".concat(i,".").concat(f)]||d[f]||h[f]||a;return r?o.a.createElement(p,s(s({ref:t},c),{},{components:r})):o.a.createElement(p,s({ref:t},c))}));function p(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var a=r.length,i=new Array(a);i[0]=f;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var c=2;c<a;c++)i[c]=r[c];return o.a.createElement.apply(null,i)}return o.a.createElement.apply(null,r)}f.displayName="MDXCreateElement"},176:function(e,t,r){e.exports=r(271)},271:function(e,t,r){"use strict";r.r(t),r.d(t,"Action",(function(){return ne})),r.d(t,"Atom",(function(){return l})),r.d(t,"Resolvable",(function(){return u})),r.d(t,"Selector",(function(){return L})),r.d(t,"StateXProvider",(function(){return re})),r.d(t,"action",(function(){return Se})),r.d(t,"atom",(function(){return ae})),r.d(t,"hasSelector",(function(){return i})),r.d(t,"hasStateX",(function(){return a})),r.d(t,"isReactElement",(function(){return E})),r.d(t,"isResolvable",(function(){return c})),r.d(t,"isSelectorNode",(function(){return s})),r.d(t,"selector",(function(){return be})),r.d(t,"useDebug",(function(){return Ne})),r.d(t,"useLatest",(function(){return oe})),r.d(t,"usePrintTree",(function(){return $e})),r.d(t,"useRemoveStateX",(function(){return we})),r.d(t,"useStateX",(function(){return ve})),r.d(t,"useStateXAction",(function(){return ye})),r.d(t,"useStateXCallback",(function(){return le})),r.d(t,"useStateXForCheckbox",(function(){return Ae})),r.d(t,"useStateXForNumberInput",(function(){return Te})),r.d(t,"useStateXForSelect",(function(){return Re})),r.d(t,"useStateXForTextInput",(function(){return Ve})),r.d(t,"useStateXForToggle",(function(){return Ue})),r.d(t,"useStateXGetter",(function(){return se})),r.d(t,"useStateXRef",(function(){return Ce})),r.d(t,"useStateXRefGetter",(function(){return ue})),r.d(t,"useStateXRefValue",(function(){return Pe})),r.d(t,"useStateXResolveable",(function(){return ge})),r.d(t,"useStateXSetter",(function(){return ie})),r.d(t,"useStateXValue",(function(){return he})),r.d(t,"useStateXValueGetter",(function(){return ce})),r.d(t,"useStateXValueInternal",(function(){return fe})),r.d(t,"useStateXValueRemover",(function(){return Oe})),r.d(t,"useStateXValueResolveable",(function(){return pe})),r.d(t,"useStateXValueSetter",(function(){return de})),r.d(t,"useWithStateX",(function(){return je}));var n=r(0),o=r.n(n);function a(e){return void 0!==e.atom}function i(e){return void 0!==e.selector}function s(e){return void 0!==e.data.selector}class u{constructor(e,t,r=!1){this.cancelled=!1,this.clone=()=>{const e=new u(this.selectorNode,this.self,this.isDefault);return e.value=this.value,e.status=this.status,e.promise=this.promise,e.error=this.error,e.cancelled=this.cancelled,e},this.resolveIfSelf=e=>{switch(this.status){case"pending":throw this.promise;case"error":throw this.error;default:if(this.selectorNode===e&&this.self)return this.value;throw this.promise}},this.resolve=()=>{switch(this.status){case"pending":throw this.promise;case"error":throw this.error;default:return this.value}},this.selectorNode=e,this.status="pending",this.self=t,this.isDefault=r}static withValue(e,t,r=!1){const n=new u(e,!0,r);return n.value=t,n.status="resolved",n}}function c(e){return e instanceof u}class l{constructor(e){this.path=e.path,this.defaultValue=e.defaultValue,this.shouldComponentUpdate=e.shouldComponentUpdate,this.updater=e.updater,this.onChange=e.onChange}}function d(e){return null!==e&&Array.isArray(e)}function h(e){return e&&"object"==typeof e}function f(e){return null==e}function p(e){return Array.isArray(e)}let g=!0;function m(e){g=e}function v(e){return Array.isArray(e)?[...e]:Object.assign({},e)}function b(e,t,r){if(d(e)){if("number"==typeof t)return function(e,t,r){if(e[t]===r)return e;if(g&&!Object.isFrozen(e))return e[t]=r,e;if(t===e.length)return[...e,r];{const n=v(e);return n[t]=r,n}}(e,t,r(e.length>t?e[t]:void 0));throw Error(`Invalid key ${String(t)}. Must be of type number.`)}return h(e)?function(e,t,r){return e[t]===r?e:g&&!Object.isFrozen(e)?(e[t]=r,e):Object.assign(Object.assign({},e),{[t]:r})}(e,t,r(e[t])):e}function S(e,t,r){return b(e,t,()=>r)}function y(e,t){if(d(e)){if("number"==typeof t)return e.length>t?e[t]:void 0;throw Error(`Invalid key ${t}. Must be of type number.`)}if(h(e))return e[t]}function O(e,t,r){const n=function e(t,r,n){if(0===r.length&&0===n)return t;const o=r[n];if(r.length===n+1)return y(t,o);const a=y(t,o);if(!f(a)){if(!h(a))throw console.error(t,r,n),Error(`Invalid path ${JSON.stringify(r)} at index ${n}. Must be an object. Instead found ${a}`);return e(a,r,n+1)}}(e,t,0);return void 0===n?r:n}function w(e,t,r){return function(e,t,r){return function e(t,r,n,o,a){if(0===r.length&&0===n)return o(t);const i=r[n];if(r.length===n+1)try{if(a){if("number"==typeof i&&d(t))return function(e,t,r){if(d(e)){if(t<e.length){const n=e.slice(0,t),o=e.slice(t);return[...n,r(e[t]),...o]}if(t===e.length)return[...e,r(void 0)];throw Error(`Index out of bound! Index ${t}. Size ${e.length}.`)}throw Error("insert called on invalid collection. collection must be of type Array.")}(t,i,o);throw Error("insertIn called on invalid collection. \n          leaf collection must be of type Array \n          & leaf path must be a number.")}return b(t,i,o)}catch(t){throw Error(`${t.message} Path: ${JSON.stringify(r)}.`)}let s,u;try{s=y(t,i)}catch(t){throw Error(`${t.message} Path: ${JSON.stringify(r)} at index ${n}.`)}if(f(s))u="number"==typeof r[n+1]?[]:{};else{if(!h(s))throw Error(`Invalid path ${JSON.stringify(r)} at index ${n}. Must be an object.`);u=s}if(u=e(u,r,n+1,o,a),u===s)return t;try{return S(t,i,u)}catch(t){throw Error(`${t.message} Path: ${JSON.stringify(r)} at index ${n}.`)}}(e,t,0,r,!1)}(e,t,()=>r)}function j(e,t,r){const n=t[r];if(t.length===r+1)return function(e,t){if(function(e,t){if(d(e)){if("number"==typeof t)return e.hasOwnProperty(t);throw Error(`Invalid key ${t}. Must be of type number.`)}return!!h(e)&&e.hasOwnProperty(t)}(e,t)){if(d(e)){if("number"==typeof t)return[...e.slice(0,t),...e.slice(t+1)];throw Error(`Invalid key ${t}. Must be of type number.`)}const r=v(e);if(h(r))return delete r[t],r}return e}(e,n);const o=y(e,n);let a;return f(o)?e:(a=function(e,t){if(null!==e&&(Array.isArray(e)||"object"==typeof e))return e;throw Error(t)}(o,`Invalid path ${JSON.stringify(t)} at index ${r}. Must be an object.`),a=j(a,t,r+1),a===o?e:S(e,n,a))}function N(e){return e instanceof Promise||e&&"object"==typeof e&&"function"==typeof e.then}function E(e){switch(typeof e.$$typeof){case"symbol":case"number":return!0}return!1}let C=!1;function P(e){C=!e,m(e)}function V(){}const R=Object.freeze({});function T(e,t){if(!t||0===Object.keys(t).length)return e;const r=[...e];Object.entries(t).forEach(e=>{const t=r.indexOf(":"+e[0]);-1!==t&&(r[t]=e[1])});const n=r.filter(e=>"string"==typeof e&&":"===e.charAt(0));if(n.length)throw Error(`Missing parameter values for ${n.join(", ")} in path ${JSON.stringify(r)}. Params passed ${JSON.stringify(t)}`);return r}function _(e,t,r,n=!0){if(0===t.path.length)return e.getState();const o=O(e.getState(),t.path,r);return void 0===o?r:o}function U(e,t){const r=_(e,t);return t.data.lastKnownValue!==r}function A(e,t){const r=t.filter(e=>"string"==typeof e&&":"===e.charAt(0));if(r.length)throw Error(`Missing parameter values for ${r.join(", ")} in path ${JSON.stringify(t)}!`);return e.trie().getNode(t)}function $(e,t){return e.data.holders.add(t),t.holding=!0,()=>{t.holding=!1,e.data.holders.delete(t)}}function k(e,t,r){const n=e.trie().getAllParentNodes(t.path),o=n.length;let a;for(let i=0;i<o&&(a=n[i],!r.has(a));i++)r.add(a)}function M(e){const t=function(e){const t=new Set;let r;return e.getPendingPaths().forEach(n=>{r=e.trie().getNode(n),U(e,r)?(t.add(r),e.trie().getAllChildNodes(n,t=>U(e,t)).forEach(t.add,t),k(e,r,t)):r.parent&&!t.has(r.parent)&&U(e,r.parent)&&k(e,r,t)}),t}(e);if(e.clearPending(),0===t.size)return;const r=[];t.forEach(t=>{if(!s(t)){const n=_(e,t),{lastKnownValue:o,holders:a,atom:i}=t.data,s=c(o)&&"pending"===o.status;n!==o&&(t.data.lastKnownValue=n,(s||!(null==i?void 0:i.shouldComponentUpdate)||i.shouldComponentUpdate(n,o))&&a.forEach(t=>{if(t.holding){let a=!0;t.shouldComponentUpdate&&(e.beforeShouldComponentUpdate(t.node),a=t.shouldComponentUpdate(n,o),e.afterShouldComponentUpdate(t.node)),(s||a)&&(t.setter(s||n),r.push(t.node)),s||t.onChange&&(e.beforeOnChange(t.node),t.onChange({call:J(e),get:F(e),getRef:W(e),oldValue:o,set:D(e),value:n}),e.afterOnChange(t.node))}}),(null==i?void 0:i.onChange)&&(e.beforeAtomOnChange(t),i.onChange({call:J(e),get:F(e),getRef:W(e),oldValue:o,set:D(e),value:n}),e.afterAtomOnChange(t)))}})}function X(e,t,r,n){return function(e,t,r,n){var o,a;let i,u,c;if(e.activateNode(t,"update",r),c=s(t)?null!==(o=t.data.selectorValue)&&void 0!==o?o:t.data.selector.defaultValue:_(e,t),i=function(e){return"function"!=typeof e}(r)?r:r(c),i===c)return c;if(s(t))u=t.data.selector.setValue(e,t,i,n);else{if("function"==typeof(null===(a=t.data.atom)||void 0===a?void 0:a.updater)&&(e.beforeAtomUpdater(t),i=t.data.atom.updater({call:J(e),get:F(e),getRef:W(e),oldValue:c,set:D(e),value:i}),e.afterAtomUpdater(t)),i===c)return c;u=i,e.updatingState(t),e.trackAndMutate(t,i),e.addToPending(t.path,"update")}return u}(e,t,r,n)}function x(e,t,r){return function(e,t){const r=e.trie().getNode(t);e.activateNode(r,"remove");const n=_(e,r);return r.data.lastKnownValue=n,e.removingState(r),e.trackAndRemove(r),r.parent&&e.addToPending(r.parent.path,"remove-child"),e.trie().removeNode(r),n}(e,T(t,null==r?void 0:r.params))}function I(e,t,r){t instanceof l&&r.data.atom!==t?(r.data.atom=t,r.data.defaultValue=t.defaultValue,void 0===O(e.getState(),r.path,void 0)&&(e.trackAndMutate(r,t.defaultValue),e.addToPendingWithoutSchedule(r.path,"default"))):t instanceof L&&r.data.selector!==t&&(r.data.selector=t,s(r)&&(r.data.initialized=!1))}function z(e,t){let r;if(e instanceof l)r=e.path;else if(e instanceof L)r=e.pathWithParams;else{if(!Array.isArray(e))throw Error(`Invalid state ${JSON.stringify(e)}. Must be path or atom or selector.`);r=e}return T(r,t)}function F(e,t){return(r,n)=>{const o=z(r,null==n?void 0:n.params),a=A(e,o);return I(e,r,a),t&&t.add(A(e,o)),function(e,t,r){const n=function(e,t,r){var n;const{mutableRefObject:o}=r||R;return s(t)?t.data.selector.getValue(e,t,r):null!==(n=_(e,t,void 0,o))&&void 0!==n?n:t.data.defaultValue}(e,t,r);return c(n)?n.resolve():n}(e,a,n)}}function J(e){return(t,r)=>t.execute(e,r)}function W(e){return t=>A(e,t).data.ref}function D(e){return(t,r,n)=>{const o=z(t,null==n?void 0:n.params),a=A(e,o);return I(e,t,a),X(e,a,r,n)}}function G(e){return(t,r)=>{const n=z(t,null==r?void 0:r.params),o=A(e,n);return I(e,t,o),x(e,o.path,r)}}function K(){throw Error("Not a writable selector!")}class L{constructor({path:e,get:t,set:r,shouldComponentUpdate:n,defaultValue:o}){this.dynamic=!1,this.params=new Map,this._evaluate=(e,t)=>{const{call:r,get:n,getRef:o,set:a,remove:i,options:s}=t,u=A(e,T(this.pathWithParams,null==s?void 0:s.params));let c;e.activateNode(u,"read"),e.beforeSelectorGet(u);try{c=this._get({call:r,get:n,getRef:o,params:null==s?void 0:s.params,remove:i,set:a})}catch(t){return this.makeResolvable(e,u,!1,t,null==s?void 0:s.params)}finally{e.afterSelectorGet(u)}return N(c)?this.makeResolvable(e,u,!0,c,null==s?void 0:s.params):(u.data.selectorValue=c,delete u.data.resolveable,c)},this.getValue=(e,t,r)=>{var n;return t.data.initialized?t.data.resolveable?t.data.resolveable:t.data.selectorValue:(null===(n=t.data.previousNodes)||void 0===n||n.forEach(e=>{var r;null===(r=t.data.unregisterMap.get(e))||void 0===r||r()}),t.data.unregisterMap=new Map,t.data.previousNodes=new Set,t.data.initialized=!0,this.selectValueWithStateXHolder(e,r))},this.setValue=(e,t,r,n)=>{try{return e.beforeSelectorSet(t),this._set({call:J(e),get:F(e),getRef:W(e),params:null==n?void 0:n.params,remove:G(e),set:D(e),value:r},r)}catch(t){throw e.catch(t),t}finally{e.afterSelectorSet(t)}},this.watchStateXForSelector=(e,t,r,n)=>{const o=t.data.unregisterMap.get(r);o&&(console.warn("Node already registered",t.path.join("."),r.path.join(".")),o());const a={setter:()=>{},node:t},i=$(r,a);a.setter=()=>this.update(e,t,n),t.data.unregisterMap.set(r,i)},this.update=(e,t,r)=>{const n=this.selectValueWithStateXHolder(e,r);if(c(n))try{t.data.holders.forEach(e=>e.setter(n))}catch(e){console.error(e)}else t.data.selectorValue=n,this.inform(e,n,t,!0)},this.selectValueWithStateXHolder=(e,t)=>{const r=T(this.pathWithParams,null==t?void 0:t.params),n=A(e,r),o=new Set,a=this._evaluate(e,{call:J(e),get:F(e,o),getRef:W(e),options:t,remove:G(e),set:D(e)});return o.forEach(r=>{n.data.previousNodes.has(r)?n.data.previousNodes.delete(r):this.watchStateXForSelector(e,n,r,t)}),n.data.previousNodes.forEach(e=>{var t;null===(t=n.data.unregisterMap.get(e))||void 0===t||t(),n.data.unregisterMap.delete(e)}),n.data.previousNodes=o,a},this._get=t,this._set=null!=r?r:K,this.defaultValue=o,this.pathWithParams=e,this.shouldComponentUpdate=n;for(let a=0;a<e.length;a++){const t=e[a];"string"==typeof t&&":"===t.charAt(0)&&this.params.set(t.substr(1),a)}this.params.size&&(this.dynamic=!0)}makeResolvable(e,t,r,n,o){t.data.resolveable&&(t.data.resolveable.cancelled=!0);const a=new u(t,r);return delete t.data.selectorValue,N(n)?(a.promise=n,n.then(n=>(a.value=n,a.status="resolved",a.cancelled||(r?(t.data.resolveable=a.clone(),t.data.selectorValue=n,this.inform(e,n,t,r)):this.update(e,t,o)),n)).catch(e=>{if(a.error=e,a.status="error",!a.cancelled)try{t.data.resolveable=a.clone(),t.data.holders.forEach(e=>e.setter(t.data.resolveable))}catch(e){console.error(e)}})):(a.error=n,a.status="error"),t.data.resolveable=a,a}inform(e,t,r,n){const{oldValue:o}=r.data;r.data.oldValue=t;let a=!0;this.shouldComponentUpdate&&(e.beforeShouldComponentUpdate(r),a=this.shouldComponentUpdate(t,o),e.afterShouldComponentUpdate(r)),a&&r.data.holders.forEach(r=>{if(r.holding){let n=!0;r.shouldComponentUpdate&&(e.beforeShouldComponentUpdate(r.node),n=r.shouldComponentUpdate(t,o),e.afterShouldComponentUpdate(r.node)),n&&r.setter(t),r.onChange&&(e.beforeOnChange(r.node),r.onChange({call:J(e),get:F(e),getRef:W(e),oldValue:o,set:D(e),value:t}),e.afterOnChange(r.node))}})}}class H{constructor(e){this.reset=()=>{this.root=this._createNode("_ROOT_")},this._createNode=(e,t)=>({children:{},key:e,parent:t,path:t?[...t.path,e]:[],data:this.makeData(e,t)}),this._forEach=(e,t,r)=>{r(e,t),Object.values(e.children).forEach(e=>{this._forEach(e,t+1,r)})},this.forEach=(e,t)=>{const r=this.getNode(e);this._forEach(r,0,t)},this.getNode=(e,t=!0)=>{let r,n,o=this.root;for(let a=0;a<e.length;a++){if(n=e[a],r=o.children[n],!r){if(!t)throw Error(`Node not found at path ${e.join(".")}! Parent ${n} at index ${a} is missing!`);r=this._createNode(n,o),o.children[n]=r}o=r}return o},this.addNode=(e,t)=>{this.getNode(e).data=t},this.removeNode=e=>{var t;null===(t=e.parent)||void 0===t||delete t.children[e.key]},this._collectAllParentNodes=(e,t)=>{t.parent&&(e.push(t.parent),this._collectAllParentNodes(e,t.parent))},this.getAllParentNodes=e=>{const t=[];return this._collectAllParentNodes(t,this.getNode(e)),t},this._collectAllChildNodes=(e,t,r)=>{let n;for(const o in e.children)n=e.children[o],r&&!r(n)||(t.push(n),this._collectAllChildNodes(n,t,r))},this.getAllChildNodes=(e,t)=>{const r=[];return this._collectAllChildNodes(this.getNode(e),r,t),r},this.isRootNode=e=>e===this.root,this.makeData=e,this.root=this._createNode("_ROOT_")}}function q(){throw new Error("This component must be used inside a <StateXProvider> component.")}class B{constructor(e={},t=V){this._trie=new H(()=>({holders:new Set,defaultValue:void 0})),this.activeNodes=new Map,this.mutatedNodes=new Set,this.pending=[],this.updateSchedule=q,this.renderSchedule=q,this.postUpdateSchedule=q,this.postRenderSchedule=q,this.id=0,this.rendering=!1,this._renderTimeout=0,this._updateTimeout=0,this.registerPreUpdateScheduler=e=>{this.updateSchedule=e},this.registerPreRenderScheduler=e=>{this.renderSchedule=e},this.registerPostUpdateScheduler=e=>{this.postUpdateSchedule=e},this.registerPostRenderScheduler=e=>{this.postRenderSchedule=e},this.state=function e(t){if("object"==typeof t&&t.current)throw Error("Ref in deepFreeze!!!");if(!function(e){return!(!C||f(e)||"object"!=typeof e||(e.current?(console.warn("ref cannot be frozen"),1):Object.isFrozen(e)||e instanceof Element||e instanceof Event||function(e){var t,r;if("undefined"==typeof window)return!1;const n=null!==(r=null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView)&&void 0!==r?r:window;return"function"==typeof n.Node?e instanceof n.Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName}(e)||E(e)||N(e)||e instanceof u&&(console.warn("Resolvable cannot be frozen"),1)))}(t))return t;const r=Object.getOwnPropertyNames(t);for(let n of r){let r=t[n];f(r)||"object"!=typeof r||e(r)}return Object.freeze(t)}(e),this.handleError=t}catch(e){this.handleError(e)}afterSelectorGet(e){}afterSelectorSet(e){}beforeSelectorGet(e){}beforeSelectorSet(e){}beforeShouldComponentUpdate(e){}afterShouldComponentUpdate(e){}beforeOnChange(e){}afterOnChange(e){}beforeAtomOnChange(e){}afterAtomOnChange(e){}beforeAtomUpdater(e){}afterAtomUpdater(e){}updatingState(e){}readingState(e){}removingState(e){}afterSelectorReads(){this.activeNodes.size&&this.activeNodes.clear(),this.lastLogItem=void 0,this.mutatedNodes.size&&(this.processTrackedMutates(),M(this)),P(!0)}renderingStarted(){this.rendering=!0}renderingCompleted(){this.rendering=!1}afterStateUpdates(){this.activeNodes.size&&this.activeNodes.clear(),this._scheduleRead(),this.processTrackedMutates(),M(this)}debug(e,t,r){}activateNode(e,t,r){var n;let o=null!==(n=this.activeNodes.get(e))&&void 0!==n?n:0;if(o>10)throw Error(`Trying to ${t} $${e.path.join(".")} too many times!`);this.activeNodes.set(e,++o),this.scheduleForUpdate(e,t)}scheduleForUpdate(e,t){switch(t){case"read":this._scheduleRead();break;default:if(this._scheduleUpdate(),this.rendering){const r=`WARNING: Trying to ${t} $${e.path.join(".")} during render!`;console.warn(r,t)}}}addToPendingWithoutSchedule(e,t){this.pending.push(e)}_scheduleRead(){this._renderTimeout&&clearTimeout(this._renderTimeout),this._renderTimeout=setTimeout(()=>{delete this._renderTimeout,this.renderSchedule(),this.postRenderSchedule()},0)}_scheduleUpdate(){this._updateTimeout&&clearTimeout(this._updateTimeout),this._updateTimeout=setTimeout(()=>{delete this._updateTimeout,this.updateSchedule(),this.postUpdateSchedule()},0)}destroy(){this._renderTimeout&&clearTimeout(this._renderTimeout),this._updateTimeout&&clearTimeout(this._updateTimeout),delete this._renderTimeout,delete this._updateTimeout,this.updateSchedule=q,this.renderSchedule=q,this.postUpdateSchedule=q,this.postRenderSchedule=q,this._trie.reset(),delete this._trie,delete this.state,this.mutatedNodes.clear(),delete this.mutatedNodes,this.activeNodes.clear(),delete this.activeNodes,delete this.pending}addToPending(e,t){this.addToPendingWithoutSchedule(e,t),this._scheduleUpdate()}trie(){return this._trie}clearPending(){this.pending=[]}getPendingPaths(){return this.pending}getState(){return this.state}setState(e){this.state=e}trackAndMutate(e,t){e.parent&&this.mutatedNodes.add(e.parent),m(!0),this.setState(w(this.getState(),e.path,t)),m(!1)}trackAndRemove(e){e.parent&&this.mutatedNodes.add(e.parent),m(!0),this.setState(j(this.getState(),e.path,0)),m(!1)}processTrackedMutates(){m(!1),this.mutatedNodes.forEach(e=>{let t=O(this.getState(),e.path,void 0);t&&"object"==typeof t&&(t=Array.isArray(t)?[...t]:Object.assign({},t),this.setState(w(this.getState(),e.path,t)))}),this.mutatedNodes.clear()}}const Q=Object(n.createContext)({current:new B});function Y(){return Object(n.useContext)(Q).current}function Z(e){console.error("Unhandled Exception!"),console.error(e)}function ee({registerPreUpdateScheduler:e,registerPreRenderScheduler:t}){const r=Y();r.renderingStarted();const[o,a]=Object(n.useState)([]);e(()=>a([]));const[i,s]=Object(n.useState)([]);return t(()=>s([])),Object(n.useLayoutEffect)(()=>{r.renderingCompleted()},[i,r,o]),Object(n.useEffect)(()=>{r.afterStateUpdates()},[r,o]),Object(n.useEffect)(()=>{P(!1)},[]),Object(n.useEffect)(()=>()=>{e(q),t(q)},[t,e]),null}function te({registerPostUpdateScheduler:e,registerPostRenderScheduler:t}){const r=Y(),[,o]=Object(n.useState)([]);e(()=>o([]));const[a,i]=Object(n.useState)([]);return t(()=>i([])),Object(n.useLayoutEffect)(()=>{r.afterSelectorReads()},[a,r]),Object(n.useEffect)(()=>{P(!1)},[]),Object(n.useEffect)(()=>()=>{e(q),t(q)},[t,e]),null}function re({initialState:e={},handleError:t=Z,children:r}){const a=Object(n.useMemo)(()=>new B(e,t),[]),i=Object(n.useRef)(a);return Object(n.useEffect)(()=>()=>a.destroy(),[a]),o.a.createElement(Q.Provider,{value:i},o.a.createElement(ee,{registerPreUpdateScheduler:i.current.registerPreUpdateScheduler,registerPreRenderScheduler:i.current.registerPreRenderScheduler}),r,o.a.createElement(te,{registerPostUpdateScheduler:i.current.registerPostUpdateScheduler,registerPostRenderScheduler:i.current.registerPostRenderScheduler}))}class ne{constructor(e){this.execute=(e,t)=>{try{return this.fn({set:D(e),get:F(e),getRef:W(e),call:J(e),remove:G(e)},t)}catch(t){throw e.catch(t),t}},this.fn=e}}function oe(e){const t=Object(n.useRef)(e);return Object(n.useLayoutEffect)(()=>{t.current=e},[e]),t}function ae(e){return new l(e)}function ie(){const e=Y();return Object(n.useMemo)(()=>D(e),[e])}function se(){const e=Y();return Object(n.useMemo)(()=>F(e),[e])}function ue(){const e=Y();return Object(n.useMemo)(()=>W(e),[e])}function ce(){return se()}function le(e,t){const r=oe(e),o=Y();return Object(n.useCallback)((...e)=>r.current({get:F(o),set:D(o),getRef:W(o)},...e),[...t,r,o])}function de(e,t){const r=z(e,null==t?void 0:t.params),o=Y(),a=A(o,r),i=oe(t);return Object(n.useCallback)(e=>X(o,a,e,i.current),[o,a,i])}function he(e,t,r){let n;if(e instanceof l)n=e.defaultValue,r=t;else if(e instanceof L)n=e.defaultValue,r=t;else{if(!p(e))throw Error("Invalid atom type value! Must be either an atom, selector or path.");void 0===t&&(t=null),n=t}return fe(e,n,r)}function fe(e,t,r){const n=z(e,null==r?void 0:r.params),o=A(Y(),n);let a=me(o,e,t,r);return c(a)&&(a=a.resolveIfSelf(o)),a}function pe(e,t){const r=z(e,null==t?void 0:t.params),n=A(Y(),r),o=me(n,e,e.defaultValue,t);return c(o)?o:u.withValue(n,o)}function ge(e,t){return[pe(e,t),de(e,t)]}function me(e,t,r,o){const a=Y();I(a,t,e),void 0===e.data.defaultValue&&(e.data.defaultValue=r);const i=Object(n.useRef)({setter:V,shouldComponentUpdate:null==o?void 0:o.shouldComponentUpdate,onChange:null==o?void 0:o.onChange,node:e}),[l,d]=Object(n.useState)(u.withValue(e,r,!0));let h,f=!1;t instanceof L?e!==i.current.node?(h=r,f=!0):h=l:(h=_(a,e,void 0,!!(null==o?void 0:o.mutableRefObject)),void 0===h&&void 0!==r&&(h=r,e.data.lastKnownValue=r,a.trackAndMutate(e,r),f=!0,a.addToPendingWithoutSchedule(e.path,"default")));const p=Object(n.useRef)({defaultValue:r,options:o,currentValue:h}),[g,m]=Object(n.useState)(h);Object(n.useEffect)(()=>{f&&(s(e)?c(l)&&l.isDefault&&l.value!==r&&d(u.withValue(e,r,!0)):g!==r&&m(r),a.addToPending(e.path,"update"))},[r,g,e,l,a,f]);const v=Object(n.useCallback)(t=>{s(e)?d(t):m(t)},[d,m,e]);return Object(n.useEffect)(()=>{p.current.currentValue=h,p.current.defaultValue=r,p.current.options=o,i.current.shouldComponentUpdate=null==o?void 0:o.shouldComponentUpdate,i.current.onChange=null==o?void 0:o.onChange,i.current.setter=v,i.current.node=e},[h,r,o,e,v]),Object(n.useEffect)(()=>{const{defaultValue:t,options:r}=p.current;if(s(e)){const t=e.data.selector.getValue(a,e,r);d(t)}else{const n=_(a,e,void 0,!!(null==r?void 0:r.mutableRefObject));void 0===n?void 0!==t&&(v(t),e.data.selector||(e.data.lastKnownValue=t,a.trackAndMutate(e,t),a.addToPending(e.path,"update"))):v(n)}},[e,v,a]),Object(n.useEffect)(()=>$(e,i.current),[e,i]),h}function ve(e,t,r){let n;if(e instanceof l)n=e.defaultValue,r=t;else if(e instanceof L)n=e.defaultValue,r=t;else{if(!p(e))throw Error("Invalid atom type value! Must be either an atom, selector or path.");void 0===t&&(t=null),n=t}return[fe(e,n,r),de(e,r)]}function be(e){return new L(e)}function Se(e){return new ne(e)}function ye(e){const t=Y();return r=>e.execute(t,r)}function Oe(e,t){const r=z(e,null==t?void 0:t.params),o=Y(),a=A(o,r),i=oe(t);return Object(n.useCallback)(()=>x(o,a.path,i.current),[a,i,o])}function we(e,t,r){let n;if(e instanceof l)n=e.defaultValue,r=t;else{if(!p(e))throw Error("Invalid atom type value! Must be either an atom, selector or path.");void 0===t&&(t=null),n=t}return[fe(e,n,r),Oe(e,r)]}function je(e){const t=Y(),r=de([]),o=Object(n.useRef)(e),a=Object(n.useRef)(!0);a.current&&(a.current=!1,t.trie().reset(),t.setState(w(t.getState(),[],e))),Object(n.useEffect)(()=>{JSON.stringify(o.current)!==JSON.stringify(e)&&(r(e),o.current=e)},[r,e])}function Ne(){const e=Y();return Object(n.useCallback)((t,r,n)=>{e.debug(t,r,n)},[e])}function Ee(e,t){const r=de(e,t);return[Object(n.useCallback)(e=>r(e.target.value),[r]),r]}function Ce(e){const t=Object(n.useRef)(null),r=A(Y(),e);return r.data.ref||(r.data.ref=t),Object(n.useEffect)(()=>()=>{r.data.ref=void 0},[r]),r.data.ref}function Pe(e){return A(Y(),e).data.ref}function Ve(e,t,r){let n;if(e instanceof l)n=e.defaultValue,r=t;else{if(!p(e))throw Error("Invalid atom type value! Must be either an atom or path.");"string"!=typeof t&&(t=""),n=t}const o=fe(e,n,r),[a]=Ee(e,r);return{value:o,onChange:a,type:(null==r?void 0:r.type)||"text"}}function Re(e,t){const r=he(e,t)||"",[n]=Ee(e,t);return{value:r,onChange:n}}function Te(e,t,r){let o;if(e instanceof l)o=e.defaultValue,r=t;else{if(!p(e))throw Error("Invalid atom type value! Must be either an atom or path.");"number"!=typeof t&&(t=0),o=t}const a=fe(e,o,r),[i]=function(e){const t=de(e);return[Object(n.useCallback)(e=>{const r=Number(e.target.value);Number.isNaN(r)||t(r)},[t]),t]}(e);return{value:a,onChange:i,type:"number"}}function _e(e,t){const r=de(e,t);return[Object(n.useCallback)(()=>{r(e=>!e)},[r]),r]}function Ue(e,t,r){let n;if(e instanceof l)n=e.defaultValue,r=t;else{if(!p(e))throw Error("Invalid atom type value! Must be either an atom or path.");"boolean"!=typeof t&&(t=!1),n=t}const o=fe(e,n,r),[a]=_e(e,r);return[!!o,a]}function Ae(e,t,r){let n;if(e instanceof l)n=e.defaultValue,r=t;else{if(!p(e))throw Error("Invalid atom type value! Must be either an atom or path.");"boolean"!=typeof t&&(t=!1),n=t}const o=fe(e,n,r),[a]=_e(e,r);return{onChange:a,checked:!!o,type:"checkbox"}}function $e(){const e=Y();return t=>{const r=[];e.trie().forEach(t,(e,t)=>{r.push(`${"".padStart(2*t,"-")}${e.path.join(".")} ${e.data.holders.size}`),e.data.holders.forEach(e=>{r.push(`${"".padStart(2*t+2," ")}${e.node.path.join(".")}`)})}),console.log(r.join("\n"))}}}}]);